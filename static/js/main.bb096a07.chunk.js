(this["webpackJsonpbreakout-game"]=this["webpackJsonpbreakout-game"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(7),c=n.n(a),s=(n(13),n(14),n(4)),o=(n(5),function(e,t){return window.addEventListener(e,t),function(){return window.removeEventListener(e,t)}});function u(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[Math.floor(Math.random()*t.length)]},f=["#4ABFF0","#F23737","#835995","#9FCE31","#FFCC00"],h=9,v=11,d=function(e){var t=e.x,n=e.y,r=e.radius;return i.a.createElement("circle",{className:"ball",cx:t,cy:n,r:r})},y=function(e){var t=e.x,n=e.y,r=e.width,a=e.height,c=e.density,s=e.color;return i.a.createElement("g",null,i.a.createElement("rect",{className:"block",fill:s,x:t,y:n,rx:r/16,width:r-5,height:a-3}),i.a.createElement("text",{x:t+r/2-6,y:n+a/2+3,"font-size":20,class:"level"},c))},m=n(1),b=n(3),w=n(2),j=function(){function e(t,n){Object(w.a)(this,e),this.x=t,this.y=n}return Object(b.a)(e,[{key:"scaleBy",value:function(t){return new e(this.x*t,this.y*t)}},{key:"length",value:function(){return Math.hypot(this.x,this.y)}},{key:"add",value:function(t){var n=t.x,r=t.y;return new e(this.x+n,this.y+r)}},{key:"normalize",value:function(){return this.scaleBy(1/this.length())}},{key:"subtract",value:function(t){var n=t.x,r=t.y;return new e(this.x-n,this.y-r)}},{key:"dotProduct",value:function(e){var t=e.x,n=e.y;return this.x*t+this.y*n}},{key:"projectOn",value:function(t){var n=this.dotProduct(t)/t.length();return new e(n*t.x,n*t.y)}},{key:"reflect",value:function(e){return this.subtract(this.projectOn(e).scaleBy(2))}},{key:"rotate",value:function(t){var n=function(e){return e*Math.PI/180}(t),r=Math.cos(n),i=Math.sin(n);return new e(this.x*r-this.y*i,this.x*i+this.y*r)}},{key:"crossProduct",value:function(e){var t=e.x,n=e.y;return this.x*n-t*this.y}},{key:"angleBetween",value:function(e){return 180*Math.atan2(this.crossProduct(e),this.dotProduct(e))/Math.PI}}]),e}(),g=(new j(0,1),function(){function e(t,n){Object(w.a)(this,e),this.makeBlock=this.randomize(),this.density=t,this.position=new j(n,0),this.width=1,this.height=1,this.id=u(),this.color=f[Math.floor(Math.random()*f.length)]}return Object(b.a)(e,[{key:"add",value:function(e,t){this.position.add(e,t)}},{key:"randomize",value:function(){return Math.floor(1.6*Math.random())}}]),e}()),x=function(){function e(){Object(w.a)(this,e),this.levelList=[],this.currentLevel=0}return Object(b.a)(e,[{key:"addLevel",value:function(){this.currentLevel++;var e=[];this.levelList!==[]&&this.transformLevelsDown();for(var t=0;t<h;t++){var n=new g(this.currentLevel,t);0!==n.makeBlock&&e.push(n)}this.levelList.unshift(e),this.levelList=this.levelList.flat()}},{key:"transformLevelsDown",value:function(){this.levelList.forEach((function(e){var t=e.position,n=new j(t.x,t.y+1);e.position=n}))}}]),e}(),O=new j(-1,0),E=new j(1,0),p=new j(0,-1),k=new j(0,1),M=O.add(p).normalize(),N=E.add(p).normalize(),A=function e(t,n,r,i,a){Object(w.a)(this,e),this.center=new j(t,n),this.direction=r,this.radius=i,this.id=a},B=function(){function e(){Object(w.a)(this,e),this.ballsArray=[],this.markerBall=new A(h/2,v-.2,l(M,N),.2,0),this.firstBall=!1,this.isStarted=!1}return Object(b.a)(e,[{key:"reset",value:function(){this.firstBall=!1,this.isStarted=!1}},{key:"addBall",value:function(e){if(Number.isNaN(e.x)||Number.isNaN(e.y));else{var t=u(),n=new A(this.markerBall.center.x,this.markerBall.center.y,e,.2,t);this.ballsArray.push(n),this.isStarted=!0}}},{key:"updatePhysics",value:function(e,t){var n=this;return this.ballsArray.forEach((function(r){var i=e.level,a=.005*t,c=n.ballsArray.findIndex((function(e){return e.id==r.id})),s=r.radius,o=r.direction,u=r.center.add(o.scaleBy(a)),l=u.y+s;if(l>v){!1===n.firstBall&&(n.firstBall=!0,n.markerBall=new A(r.center.x,v-.2,{x:0,y:0},.2,0));var f=n.ballsArray.filter((function(e){return e.id!=r.id}));return n.ballsArray=f}var d=function(e){n.ballsArray[c]=Object(m.a)({},r,{},e)},y=function(e){var t=I(o.reflect(e)),n=S(e,t);return d({direction:n})},b=u.x-s,w=u.x+s,j=u.y-s;if(j<=0)return y(k);if(b<=0)return y(E);if(w>=h)return y(O);var g=i.levelList.find((function(e){var t=e.position,n=e.width,r=e.height;return R(j,l,t.y,t.y+r)&&R(b,w,t.x,t.x+n)}));if(g){if(g.density=g.density-1,g.density<=0){var x=e.level.levelList.filter((function(e){return e.id!=g.id}));e.level.levelList=x}return Object(m.a)({},y(function(){var e=g.position.y,t=e+g.height,n=g.position.x;if(j>e-s&&l<t+s){if(b<n)return O;if(w>n+g.width)return E}return j>e?k:j<=e?p:void 0}()))}return d({center:u})})),e}}]),e}(),L=function(e,t){var n=e.width/h,r=e.height/v,i=Math.min(r,n);return{projectDistance:function(e){return e*i},projectDistanceReverse:function(e){return e/i},projectVector:function(e){return e.scaleBy(i)},projectVectorReverse:function(e){return e.scaleBy(1/i)}}},I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.3,n=function(){return Math.random()*t-t/2},r=new j(n(),n());return e.add(r).normalize()},R=function(e,t,n,r){return e>=n&&e<=r||t>=n&&t<=r},S=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,r=e.angleBetween(t),i=90-n;if(r<0){if(r>-n)return e.rotate(-n);if(r<-i)return e.rotate(-i)}else{if(r<n)return e.rotate(n);if(r>i)return e.rotate(i)}return t},P={CONTAINER_SIZE_CHANGE:"CONTAINER_SIZE_CHANGE",KEY_UP:"KEY_UP",MOUSE_MOVE:"MOUSE_MOVE",TICK:"TICK"},C=function(e,t){var n=t.type,r=t.payload;switch(n){case P.CONTAINER_SIZE_CHANGE:return _(e,r);case P.KEY_UP:return z(e,r);case P.AIMING:return D(e,r);case P.MOUSE_MOVE:return Y(e,r);case P.TICK:return V(e);default:return e}},_=function(e,t){return Object(m.a)({},e,{containerSize:t},L(t))},D=function(e,t){e.isAiming=!1;for(var n=0;n<e.levelNumber;n++)setTimeout((function(n){e.ball.addBall(new j(Math.cos(t.angle),Math.sin(t.angle)))}),100*n);return e},Y=function(e,t){return Object(m.a)({},e,{oldMousePosition:e.newMousePosition,newMousePosition:t})},z=function(e,t){return Object(m.a)({},e,{movement:void 0})},V=function(e){if(e.isAiming)return e;var t=Date.now(),n=e.ball.updatePhysics(e,t-e.time);return n.ball.isStarted&&0===n.ball.ballsArray.length&&(n.ball.isStarted=!1,n.level.addLevel(),n.isAiming=!0,n.levelNumber++,n.ball.reset()),n=Object(m.a)({},n,{time:t}),Object(m.a)({},n)},T=function(){var e=Object(r.useRef)(),t=Object(r.useState)(),n=Object(s.a)(t,2),a=n[0],c=n[1],u=Object(r.useState)({x:0,y:0}),l=Object(s.a)(u,2),f=l[0],h=l[1],v=Object(r.useState)(!1),d=Object(s.a)(v,2),y=d[0],m=d[1];return Object(r.useEffect)((function(){var t=function(){var t=e.current.getBoundingClientRect(),n=t.width,r=t.height;c({width:n,height:r})},n=o("resize",t),r=o("mousemove",(function(e){return function(e){h({x:e.clientX,y:e.clientY})}(e)})),i=o("mousedown",(function(e){m(!0)})),a=o("mouseup",(function(e){m(!1)}));return t(),{unregisterResizeListener:n,unregisterMouseMoveListener:r,unregisterMouseDownListener:i,unregisterMouseUpListener:a}}),[]),i.a.createElement("div",{className:"page"},i.a.createElement("div",{className:"scene-container",ref:e},a&&i.a.createElement(U,{width:a.width,height:a.height,mouse:f,click:y})))},K=function(e){var t=function(){var e=new x;return e.addLevel(1),{level:e}}().level,n=new B,r=L(e);return{level:t,ball:n,containerSize:e,projectDistance:r.projectDistance,projectVector:r.projectVector,projectDistanceReverse:r.projectDistanceReverse,projectVectorReverse:r.projectVectorReverse,oldMousePosition:0,newMousePosition:0,levelNumber:2,time:Date.now(),isAiming:!0}},U=function(e){var t=Object(r.useReducer)(C,e,K),n=Object(s.a)(t,2),a=n[0],c=n[1],u=function(e,t){return c({type:e,payload:t})},l=Object(r.useRef)(),f=(Object(r.useRef)(),Object(r.useRef)()),m=Object(r.useRef)(),b=Object(r.useRef)(),w=Object(r.useRef)(),g=Object(r.useRef)(),x=Object(r.useState)({x:0,y:0}),O=Object(s.a)(x,2),E=O[0],p=O[1],k=Object(r.useState)({x:0,y:0}),M=Object(s.a)(k,2),N=M[0],A=M[1],B=a.projectDistance,L=a.projectVector,I=a.projectDistanceReverse,R=(a.projectVectorReverse,a.level,a.isAiming,B(h)),S=B(v),_=B(.2),D=(new j(e.mouse.x,e.mouse.y),I(E.x)),Y=I(E.y),z=(L(new j(D,Y)),L(a.ball.markerBall.center));Object(r.useEffect)((function(){u(P.CONTAINER_SIZE_CHANGE,{width:e.width,height:e.height}),console.log(e.width)}),[e.width,e.height]),Object(r.useEffect)((function(){e.click&&a.isAiming&&u(P.AIMING,{angle:N})}),[a.isAiming,e.click,N]),Object(r.useEffect)((function(){var e,t,n;return e="mousemove",t=function(e){return function(e){p({x:e.offsetX,y:e.offsetY});var t=Math.atan2(e.offsetY-z.y,e.offsetX-z.x);A(t),V(f.current,z.x,z.y,e.offsetX,e.offsetY),V(m.current,z.x,z.y,e.offsetX,e.offsetY),V(b.current,z.x,z.y,e.offsetX,e.offsetY),V(w.current,z.x,z.y,e.offsetX,e.offsetY),V(g.current,z.x,z.y,e.offsetX,e.offsetY)}(e)},(n=l).current.addEventListener(e,t),function(){return n.current.removeEventListener(e,t)}}),[z.x,z.y,A]);var V=function(e,t,n,r,i){var a=180*Math.atan2(i-n,r-t)/Math.PI+90;e.setAttribute("transform","translate("+t+","+n+") rotate("+a+") translate("+-t+","+-n+")")};return Object(r.useEffect)((function(){var e=setInterval((function(){return u(P.TICK)}),1e3/60),t=o("keyup",(function(e){var t=e.which;return u(P.KEY_UP,t)}));return function(){clearInterval(e),t()}}),[]),i.a.createElement("svg",{width:R,height:S,className:"scene",ref:l},a.level.levelList.map((function(e){return i.a.createElement(y,Object.assign({density:e.density,key:"".concat(e.position.x,"-").concat(e.position.y),width:B(e.width),height:B(e.height),color:e.color},L(e.position)))})),a.ball.ballsArray.map((function(e){return i.a.createElement(d,Object.assign({},L(e.center),{radius:_,key:e.id}))})),i.a.createElement(d,Object.assign({},L(a.ball.markerBall.center),{radius:_})),i.a.createElement("circle",{cx:z.x,cy:z.y-(7*_*1.15+.5*_),r:.5*_,className:"ball",ref:f}),i.a.createElement("circle",{cx:z.x,cy:z.y-(7*_*.9+.6*_),r:.6*_,className:"ball",ref:m}),i.a.createElement("circle",{cx:z.x,cy:z.y-(7*_*.65+.7*_),r:.7*_,className:"ball",ref:b}),i.a.createElement("circle",{cx:z.x,cy:z.y-(7*_*.4+.8*_),r:.8*_,className:"ball",ref:w}),i.a.createElement("circle",{cx:z.x,cy:z.y-(7*_*.15+.9*_),r:.9*_,className:"ball",ref:g}))};var X=function(){return i.a.createElement(T,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,t,n){e.exports=n(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.bb096a07.chunk.js.map