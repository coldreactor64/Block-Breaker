(this["webpackJsonpbreakout-game"]=this["webpackJsonpbreakout-game"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(7),c=n.n(a),o=(n(13),n(14),n(4)),s=(n(5),function(e,t){return window.addEventListener(e,t),function(){return window.removeEventListener(e,t)}});function u(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+e()}var l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[Math.floor(Math.random()*t.length)]},f=["#4ABFF0","#F23737","#835995","#9FCE31","#FFCC00"],h=9,d=11,v=function(e){var t=e.x,n=e.y,r=e.radius;return i.a.createElement("circle",{className:"ball",cx:t,cy:n,r:r})},y=function(e){var t=e.x,n=e.y,r=e.width,a=e.height,c=e.density,o=e.color;return i.a.createElement("g",null,i.a.createElement("rect",{className:"block",fill:o,x:t,y:n,rx:r/16,width:r-5,height:a-3}),i.a.createElement("text",{x:t+r/2-6,y:n+a/2+3,"font-size":20,className:"ballid"},c))},b=n(2),m=n(3),w=function(){function e(t,n){Object(b.a)(this,e),this.x=t,this.y=n}return Object(m.a)(e,[{key:"scaleBy",value:function(t){return new e(this.x*t,this.y*t)}},{key:"length",value:function(){return Math.hypot(this.x,this.y)}},{key:"add",value:function(t){var n=t.x,r=t.y;return new e(this.x+n,this.y+r)}},{key:"normalize",value:function(){return this.scaleBy(1/this.length())}},{key:"subtract",value:function(t){var n=t.x,r=t.y;return new e(this.x-n,this.y-r)}},{key:"dotProduct",value:function(e){var t=e.x,n=e.y;return this.x*t+this.y*n}},{key:"projectOn",value:function(t){var n=this.dotProduct(t)/t.length();return new e(n*t.x,n*t.y)}},{key:"reflect",value:function(e){return this.subtract(this.projectOn(e).scaleBy(2))}},{key:"rotate",value:function(t){var n=function(e){return e*Math.PI/180}(t),r=Math.cos(n),i=Math.sin(n);return new e(this.x*r-this.y*i,this.x*i+this.y*r)}},{key:"crossProduct",value:function(e){var t=e.x,n=e.y;return this.x*n-t*this.y}},{key:"angleBetween",value:function(e){return 180*Math.atan2(this.crossProduct(e),this.dotProduct(e))/Math.PI}}]),e}(),g=n(1),j=new w(-1,0),p=new w(1,0),x=new w(0,-1),O=new w(0,1),k=j.add(x).normalize(),E=p.add(x).normalize(),N=(j.add(O).normalize(),p.add(O).normalize(),function e(t,n,r,i,a){Object(b.a)(this,e),this.center=new w(t,n),this.direction=r,this.radius=i,this.id=a}),A=function(){function e(){Object(b.a)(this,e),this.boundaryCheck=function(e,t,n,r){return e>=n&&e<=r||t>=n&&t<=r},this.ballsArray=[],this.markerBall=new N(h/2,d-.2,l(k,E),.2,0),this.firstBall=!1,this.isStarted=!1}return Object(m.a)(e,[{key:"reset",value:function(){this.firstBall=!1,this.isStarted=!1}},{key:"addBall",value:function(e){if(Number.isNaN(e.x)||Number.isNaN(e.y));else{var t=u(),n=new N(this.markerBall.center.x,this.markerBall.center.y,e,.2,t);this.ballsArray.push(n),this.isStarted=!0}}},{key:"updatePhysics",value:function(e,t){var n=this;return this.ballsArray.forEach((function(r){var i=e.level,a=.01*t,c=n.ballsArray.findIndex((function(e){return e.id==r.id})),o=r.radius,s=r.direction,u=r.center.add(s.scaleBy(a)),f=u.y+o;if(f>d){!1===n.firstBall&&(n.firstBall=!0,n.markerBall=new N(r.center.x,d-.2,{x:0,y:0},.2,0));var v=n.ballsArray.filter((function(e){return e.id!=r.id}));return n.ballsArray=v}var y=function(e){n.ballsArray[c]=Object(g.a)({},r,{},e)},b=function(e){var t=s.reflect(e);return y({direction:t})},m=u.x-o,w=u.x+o,k=u.y-o;if(k<=0)return b(O);if(m<=0)return b(p);if(w>=h)return b(j);var E=i.levelList.find((function(e){var t=e.position,r=e.width,i=e.height;return n.boundaryCheck(k,f,t.y,t.y+i)&&n.boundaryCheck(m,w,t.x,t.x+r)}));if(E){if(E.density=E.density-1,E.density<=0){var A=e.level.levelList.filter((function(e){return e.id!=E.id}));e.level.levelList=A}return Object(g.a)({},b(function(){var e=E.position.y,t=e+E.height,n=E.position.x;if(k>e-o&&f<t+o){if(m<n)return j;if(w>n+E.width)return p}return k>e&&m<n?l(j,O):k>e&&w>n+E.width?l(p,O):k>e?O:k<=e&&m<n?l(j,O):k<=e&&w>n+E.width?l(p,O):k<=e?x:void 0}()))}return y({center:u})})),e}}]),e}(),M=(new w(0,1),function(){function e(t,n){Object(b.a)(this,e),this.makeBlock=this.randomize(),this.density=t,this.position=new w(n,0),this.width=1,this.height=1,this.id=u(),this.color=f[Math.floor(Math.random()*f.length)]}return Object(m.a)(e,[{key:"add",value:function(e,t){this.position.add(e,t)}},{key:"randomize",value:function(){return Math.floor(1.6*Math.random())}}]),e}()),B=function(){function e(){Object(b.a)(this,e),this.levelList=[],this.currentLevel=0}return Object(m.a)(e,[{key:"addLevel",value:function(){this.currentLevel++;var e=[];this.levelList!==[]&&this.transformLevelsDown();for(var t=0;t<h;t++){var n=new M(this.currentLevel,t);0!==n.makeBlock&&e.push(n)}this.levelList.unshift(e),this.levelList=this.levelList.flat()}},{key:"transformLevelsDown",value:function(){this.levelList.forEach((function(e){var t=e.position,n=new w(t.x,t.y+1);e.position=n}))}}]),e}(),L=function(e,t){var n=e.width/h,r=e.height/d,i=Math.min(r,n);return{projectDistance:function(e){return e*i},projectDistanceReverse:function(e){return e/i},projectVector:function(e){return e.scaleBy(i)},projectVectorReverse:function(e){return e.scaleBy(1/i)}}},R={CONTAINER_SIZE_CHANGE:"CONTAINER_SIZE_CHANGE",KEY_UP:"KEY_UP",MOUSE_MOVE:"MOUSE_MOVE",TICK:"TICK"},S=function(e,t){var n=t.type,r=t.payload;switch(n){case R.CONTAINER_SIZE_CHANGE:return I(e,r);case R.KEY_UP:return _(e,r);case R.AIMING:return C(e,r);case R.MOUSE_MOVE:return P(e,r);case R.TICK:return D(e);default:return e}},I=function(e,t){return Object(g.a)({},e,{containerSize:t},L(t))},C=function(e,t){e.isAiming=!1;for(var n=0;n<e.levelNumber-1;n++)setTimeout((function(n){e.ball.addBall(new w(Math.cos(t.angle),Math.sin(t.angle)))}),100*n);return e},P=function(e,t){return Object(g.a)({},e,{oldMousePosition:e.newMousePosition,newMousePosition:t})},_=function(e,t){return Object(g.a)({},e,{movement:void 0})},D=function(e){if(e.isAiming)return e;var t=Date.now(),n=e.ball.updatePhysics(e,t-e.time);return n.ball.isStarted&&0===n.ball.ballsArray.length&&(n.ball.isStarted=!1,n.level.addLevel(),n.isAiming=!0,n.levelNumber++,n.ball.reset()),n=Object(g.a)({},n,{time:t}),Object(g.a)({},n)},z=function(){var e=Object(r.useRef)(),t=Object(r.useState)(),n=Object(o.a)(t,2),a=n[0],c=n[1],u=Object(r.useState)({x:0,y:0}),l=Object(o.a)(u,2),f=l[0],h=(l[1],Object(r.useState)(!1)),d=Object(o.a)(h,2),v=d[0],y=d[1];return Object(r.useEffect)((function(){var t=function(){var t=e.current.getBoundingClientRect(),n=t.width,r=t.height;c({width:n,height:r})},n=s("resize",t),r=s("mousedown",(function(e){y(!0)})),i=s("mouseup",(function(e){y(!1)}));return t(),{unregisterResizeListener:n,unregisterMouseDownListener:r,unregisterMouseUpListener:i}}),[]),i.a.createElement("div",{className:"page"},i.a.createElement("div",{className:"scene-container",ref:e},a&&i.a.createElement(U,{width:a.width,height:a.height,mouse:f,click:v})))},T=function(e){var t=function(){var e=new B;return e.addLevel(1),{level:e}}().level,n=new A,r=L(e);return{level:t,ball:n,containerSize:e,projectDistance:r.projectDistance,projectVector:r.projectVector,projectDistanceReverse:r.projectDistanceReverse,projectVectorReverse:r.projectVectorReverse,oldMousePosition:0,newMousePosition:0,levelNumber:2,time:Date.now(),isAiming:!0}},U=function(e){var t=Object(r.useReducer)(S,e,T),n=Object(o.a)(t,2),a=n[0],c=n[1],u=function(e,t){return c({type:e,payload:t})},l=Object(r.useRef)(),f=(Object(r.useRef)(),Object(r.useRef)()),b=Object(r.useRef)(),m=Object(r.useRef)(),g=Object(r.useRef)(),j=Object(r.useRef)(),p=Object(r.useState)({x:0,y:0}),x=Object(o.a)(p,2),O=x[0],k=x[1],E=Object(r.useState)({x:0,y:0}),N=Object(o.a)(E,2),A=N[0],M=N[1],B=a.projectDistance,L=a.projectVector,I=a.projectDistanceReverse,C=(a.projectVectorReverse,a.level,a.isAiming,B(h)),P=B(d),_=B(.2),D=(new w(e.mouse.x,e.mouse.y),I(O.x)),z=I(O.y),U=(L(new w(D,z)),L(a.ball.markerBall.center));Object(r.useEffect)((function(){u(R.CONTAINER_SIZE_CHANGE,{width:e.width,height:e.height})}),[e.width,e.height]),Object(r.useEffect)((function(){e.click&&a.isAiming&&u(R.AIMING,{angle:A})}),[a.isAiming,e.click,A]),Object(r.useEffect)((function(){var e,t,n;return e="mousemove",t=function(e){return function(e){k({x:e.offsetX,y:e.offsetY});var t=Math.atan2(e.offsetY-U.y,e.offsetX-U.x);M(t),V(f.current,U.x,U.y,e.offsetX,e.offsetY),V(b.current,U.x,U.y,e.offsetX,e.offsetY),V(m.current,U.x,U.y,e.offsetX,e.offsetY),V(g.current,U.x,U.y,e.offsetX,e.offsetY),V(j.current,U.x,U.y,e.offsetX,e.offsetY)}(e)},(n=l).current.addEventListener(e,t),function(){return n.current.removeEventListener(e,t)}}),[U.x,U.y,M]);var V=function(e,t,n,r,i){var a=180*Math.atan2(i-n,r-t)/Math.PI+90;e.setAttribute("transform","translate("+t+","+n+") rotate("+a+") translate("+-t+","+-n+")")};return Object(r.useEffect)((function(){var e=setInterval((function(){return u(R.TICK)}),1e3/60),t=s("keyup",(function(e){var t=e.which;return u(R.KEY_UP,t)}));return function(){clearInterval(e),t()}}),[]),i.a.createElement("svg",{width:C,height:P,className:"scene",ref:l},a.level.levelList.map((function(e){return i.a.createElement(y,Object.assign({density:e.density,key:"".concat(e.position.x,"-").concat(e.position.y),width:B(e.width),height:B(e.height),color:e.color},L(e.position)))})),a.ball.ballsArray.map((function(e){return i.a.createElement(v,Object.assign({},L(e.center),{radius:_,key:e.id}))})),i.a.createElement(v,Object.assign({},L(a.ball.markerBall.center),{radius:_})),i.a.createElement("circle",{cx:U.x,cy:U.y-(7*_*1.15+.5*_),r:.5*_,className:"ball",ref:f}),i.a.createElement("circle",{cx:U.x,cy:U.y-(7*_*.9+.6*_),r:.6*_,className:"ball",ref:b}),i.a.createElement("circle",{cx:U.x,cy:U.y-(7*_*.65+.7*_),r:.7*_,className:"ball",ref:m}),i.a.createElement("circle",{cx:U.x,cy:U.y-(7*_*.4+.8*_),r:.8*_,className:"ball",ref:g}),i.a.createElement("circle",{cx:U.x,cy:U.y-(7*_*.15+.9*_),r:.9*_,className:"ball",ref:j}))};var V=function(){return i.a.createElement(z,null)},Y=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function K(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(i.a.createElement(V,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/Block-Breaker",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/Block-Breaker","/service-worker.js");Y?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):K(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):K(t,e)}))}}()},8:function(e,t,n){e.exports=n(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.816ef5ed.chunk.js.map